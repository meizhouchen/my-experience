import{_ as a,o as e,c as n,O as t}from"./chunks/framework.3938e08f.js";const s="/my-experience/assets/1.671c6668.jpg",C=JSON.parse('{"title":"nginx","description":"","frontmatter":{},"headers":[],"relativePath":"back-end/nginx/nginx.md","filePath":"back-end/nginx/nginx.md"}'),l={name:"back-end/nginx/nginx.md"},o=t(`<h1 id="nginx" tabindex="-1">nginx <a class="header-anchor" href="#nginx" aria-label="Permalink to &quot;nginx&quot;">​</a></h1><p><a href="http://openresty.org/cn/download.html" target="_blank" rel="noreferrer">openresty</a></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">server {</span></span>
<span class="line"><span style="color:#A6ACCD;">  listen       80;</span></span>
<span class="line"><span style="color:#A6ACCD;">  server_name  localhost;</span></span>
<span class="line"><span style="color:#A6ACCD;">  default_type text/html;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">  location / {</span></span>
<span class="line"><span style="color:#A6ACCD;">      root   html;</span></span>
<span class="line"><span style="color:#A6ACCD;">      index  index.html index.htm;</span></span>
<span class="line"><span style="color:#A6ACCD;">  }</span></span></code></pre></div><h2 id="规则" tabindex="-1">规则 <a class="header-anchor" href="#规则" aria-label="Permalink to &quot;规则&quot;">​</a></h2><p>只匹配 <a href="http://localhost/a" target="_blank" rel="noreferrer">http://localhost/a</a> 匹配等级最高 location = /a</p><p>只匹配 <a href="http://localhost/a" target="_blank" rel="noreferrer">http://localhost/a</a><br> location ^~ /a // 匹配以/a开头的</p><p>只匹配 <a href="http://localhost/a" target="_blank" rel="noreferrer">http://localhost/a</a><br> location ~ /\\w // 正则匹配\\w 以/a开头的</p><p>location / 匹配以/开头的</p><ul><li>同级，按照先后顺序 location ~ ^/\\w</li></ul><p>location ~ ^/[a-z]</p><h2 id="反向代理" tabindex="-1">反向代理 <a class="header-anchor" href="#反向代理" aria-label="Permalink to &quot;反向代理&quot;">​</a></h2><p>nginx路由到其他服务器就是反向代理，它不需要客户配置；正向是面向用户，常规代理是代理客户端</p><p>代理是把访问指向某个文件</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">location /a {</span></span>
<span class="line"><span style="color:#A6ACCD;">  proxy_pass http://192.168.0.12:80;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><p>访问<a href="http://localhost/a" target="_blank" rel="noreferrer">http://localhost/a</a> 会报错404 可以访问<a href="http://192.168.0.12/a" target="_blank" rel="noreferrer">http://192.168.0.12/a</a></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">location /a/ {</span></span>
<span class="line"><span style="color:#A6ACCD;">  proxy_pass http://192.168.0.12:80/;</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span></code></pre></div><p>访问<a href="http://localhost/a" target="_blank" rel="noreferrer">http://localhost/a</a></p><h2 id="负载均衡" tabindex="-1">负载均衡 <a class="header-anchor" href="#负载均衡" aria-label="Permalink to &quot;负载均衡&quot;">​</a></h2><p><img src="`+s+`" alt=""></p><p>upstream group1{ server 192.168.0.12:80; server 192.168.0.12:81;</p><p>location /a/ { proxy_pass <a href="http://group1/1" target="_blank" rel="noreferrer">http://group1/1</a> }</p><p>设置权重</p><p>upstream group1{ server 192.168.0.12:80 weight 9; // 90%的概率访问这个地址 server 192.168.0.12:81 weight 1;</p><p>location /a/ { proxy_pass <a href="http://group1/1" target="_blank" rel="noreferrer">http://group1/1</a> }</p><h2 id="问题" tabindex="-1">问题 <a class="header-anchor" href="#问题" aria-label="Permalink to &quot;问题&quot;">​</a></h2><h3 id="_405-not-allowed问题解决方法" tabindex="-1">405 not allowed问题解决方法 <a class="header-anchor" href="#_405-not-allowed问题解决方法" aria-label="Permalink to &quot;405 not allowed问题解决方法&quot;">​</a></h3><p>正常访问Http接口时正常，但通过nginx访问却出现405 not allowed的提示。</p><h3 id="解决方案" tabindex="-1">解决方案 <a class="header-anchor" href="#解决方案" aria-label="Permalink to &quot;解决方案&quot;">​</a></h3><p>在nginx的站点配置中添加以下error_page 405 =200 $request_uri;这句即可。</p><pre><code>server {
    listen       9095;
    server_name  localhost;

#前端网站
location / {
    root D:\\dqc\\portal\\portal-vue;    # 静态页面根目录
    index index.html;#默认首页
    error_page 405 =200  $request_uri;
    }
</code></pre><p>}</p>`,31),r=[o];function p(i,c,h,d,_,g){return e(),n("div",null,r)}const x=a(l,[["render",p]]);export{C as __pageData,x as default};
