# 需求分析

## 原始需求
[【行家端】会员合并下单后，订单列表中需要显示关联会员订单信息](https://www.tapd.cn/53440148/prong/stories/view/1153440148001038656)

## 需求分析
会员合并下单, 订单详情没有展示会员这个虚拟商品的下单信息


# 解决方案
![enter image description here](/tfl/pictures/202305/tapd_53440148_1683353156_769.png)
商家配置管理新增`参与工会卡优惠活动字段`，默认不开启。
涉及页面：`src/views/shop/infomations.vue`

![enter image description here](/tfl/pictures/202305/tapd_53440148_1683354931_313.png)
**单规格菜品**编辑新增`工会卡专享价`字段。
`会员专享价`与`工会专享价`**不能同时设置**；如果同时设置，那么弹出提示“会员专享商品和工会卡专享价不能同时设置”，工会卡专享价为 0 或空时，表示该商品不参与工会卡优惠活动；
如果商品设置了“每单优惠份数”，那么无法保存，弹出提示“该商品设置了每单优化份数，无法保存工会卡专享价”。
涉及页面：`src/views/dish/dish.vue`

## 行家后台新增工会卡管理功能
### 工会卡活动管理页
![enter image description here](/tfl/pictures/202305/tapd_53440148_1683510380_960.png)
新增编辑以及禁用功能
### 工会卡活动编辑页
![enter image description here](/tfl/pictures/202305/tapd_53440148_1683510807_172.png)
1. 新增，修改或者删除红包，最多10个。
2. 红包数量限制1-99999
3. 活动有效期跨度不超过90天
4. 活动权益说明最多500字
5. 活动默认关闭
**备注**：进行中的活动可以编辑，但启用中的活动时间不能交叉，编辑红包限定数量时，红包限定数量不能小于当前的发放数量，弹出 toast 提示“红包限定数量不能小于当前的发放数量1756”；红包无法进行删除或添加；

## 红会卡专享商品推荐页
![enter image description here](/tfl/pictures/202305/tapd_53440148_1683510974_989.png)
新增行家后台-工会卡管理-工会卡专享商品推荐列表页面；
点击“新增”按钮进入到“工会卡专享商品推荐”页面；
- 推荐店铺：模糊匹配参与工会卡活动的外卖商家；
- 推荐商品：获取该商家店铺内设置了工会卡专享价的商品；
- 排序值：0-99999；
如果不启用则不展示在“工会卡特惠专区”页面；

## 工会卡认证管理
![enter image description here](/tfl/pictures/202305/tapd_53440148_1683511135_927.png)
已认证的信息可以右键，点击“删除认证”后弹出二次确认弹框，“是否确认删除[张三]的工会卡认证记录？”“取消”“确定”，确定后做加删除，认证状态改为“已删除”。

# 自测用例
|| **Test Case** || **用例目的** || **输入** || **输出** || **期望结果** || **测试结果** || **说明** ||
||商家开通工会卡专享价 ||验证商家开通工会卡专享价是否正常||商家id，是否设置工会卡专享价||||||||||
||菜品设置工会卡专享价 ||验证菜品设置工会卡专享价是否正常||菜品id，工会专享价||||||||||
||工会卡活动列表 ||验证活动列表显示是否正常||||||||||||
||工会卡活动编辑 ||验证活动编辑是否正常||红包列表，红包数量，有效期以及活动规则||||||||||
||工会卡专享商品列表||验证列表数据显示是否正常||||||||||||
||工会卡专享商品编辑 ||验证商品编辑是否正常||店铺id，商家id，排序值以及是否启用||||||||||
||工会卡认证绑定列表||验证列表数据显示是否正常||||||||||||
||工会卡认证用户解绑||验证解绑是否正常||||||||||||